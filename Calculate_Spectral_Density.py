#Author: Sepehr Roudini.
#Date: 05/02/2018.
#University of Iowa.
#Department of Chemical Engineering.
#Purpose: Calculating R2 for harmonic 
#functions


#--------------------------------------------------------------------------------------------#
#Defining function and importing necessary libraries.
#--------------------------------------------------------------------------------------------#

##############################################################################################
#Libraries used in this function are: numpy.
##############################################################################################
#Amplitudes: 1 d array of harmonic amplitudes(Cs).
##############################################################################################
#Variance:Variance of data.
##############################################################################################
#N:Number of data.
##############################################################################################
#This functions returnes Normalized spectral
#density for each harmonic
##############################################################################################
def Calculate_spectral_density(Amplitudes,Variance,N):
#numpy is for data manipulationt
    import  numpy as np
#--------------------------------------------------------------------------------------------#
#--------------------------------------------------------------------------------------------#


#--------------------------------------------------------------------------------------------#
#Computing spectral density
#--------------------------------------------------------------------------------------------#
    R2 = np.zeros(len(Amplitudes))
    for i in range(0,len(Amplitudes)):
        R2[i]=((N/2)*Amplitudes[i]**2)/((N-1)*Variance)
    return R2
#--------------------------------------------------------------------------------------------#
#--------------------------------------------------------------------------------------------#

    